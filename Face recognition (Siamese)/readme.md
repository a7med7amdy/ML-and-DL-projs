# Siamese-network-face-recognition
Siamese network application
# Requirements
.Python 3
.Pytorch
# Dataset
the dataset consists of 100 Hollywood Star that is collected from getty image website
(https://www.gettyimages.com/)

* link to dataset:- https://drive.google.com/file/d/1eP3ao6jsN8bFSTzxBpPJCBcBdBHC7xK3/view?usp=sharing
each class contains 137 images, 20 images collected from the website by (web scrapping) then
each of those 20 images is augmented by rotation, shearing, ... and the total number becomes 137 images per each class.

# Pair.txt file
the Pair.txt file is a file that is auto generated by code that its structure as the following:-

../../dwayne johnson/1.jpg   ../../dwayne johnson/23.jpg    1
../../dwayne johnson/5.jpg   ../../leonardo dicaprio/23.jpg    0

it contains the path to two images, if the two images belong to the same class, put 1 next to them.
Else put 0.

the pairs that don't belong to the same class are represented as:-

path/to/man1    path/to/man2    0
path/to/woman1  path/to/woman2  0
path/to/man1    path/to/woman2  0

this makes a large varity to give better distinguisher.

# model
is a simple model of 4 convolutional layers separated by maxpool and batch normalization takes place. the activation function used is RELU. then two fully connected layer end with sigmoid function. this sigmoid function determines if the two passed images are of the same person or not.

if output>=0.5:

	samePerson

else:

	different

# Experiments  
after training the model for more than 300 epochs, LR=0.001, optimizer SGD with momentum=0.9. Model accuracy obtained is: 0.9917.  

# the generic code
in the generic code, you can run it on any DS. But, you must make file that have pairs like the one provided above.

you can add the path to this file in main func which has path to the file as an argument sent to another func. as in ( train_dataloader, test_dataloader= buildLoders(fileName= 'pairs.txt') ).

if you want to train the model using pretrained weights, add the path to the pretrained model to "weightsPath" in "initializeArch". as (device, Net, optimizer= initializeArch(lr=0.0001, momentum=0.9, weightsPath=../../..)) by default, it's None which means train from scratch.

function plotAndShow takes path to 3 images, 2 of the same class and one of different class, it plots the 3 images together and prints which 2 are the same.

you can adjust the hyperparameters as number of epochs, LR, Momentum to SGD optimizer and so on from the main function.